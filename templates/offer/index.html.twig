{% extends 'base.html.twig' %}

{% block title %}Offer index{% endblock %}

{% block stylesheets %}
    <style>
        .quantity-btn {
            margin: 5px;
            padding: 8px 12px;
            border: 1px solid #ccc;
            background: #f5f5f5;
            cursor: pointer;
        }
        .quantity-btn.selected {
            background-color: #007bff;
            color: white;
            border-color: #0056b3;
        }
    </style>
{% endblock %}

{% block javascripts %}
    <script>
        document.querySelectorAll('.offer-form').forEach(form => {
            const buttons = form.querySelectorAll('.quantity-btn');
            const input = form.querySelector('.quantity-input');

            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Reset all buttons
                    buttons.forEach(b => b.classList.remove('selected'));
                    // Highlight selected
                    btn.classList.add('selected');
                    // Set value
                    input.value = btn.dataset.qty;
                });
            });
        });
    </script>
{% endblock %}

{% block body %}
    <h1>Offer index</h1>

    {% for offer in offers %}
        <div>
            <h3>{{ offer.name }}</h3>
            <p>{{ offer.description }}</p>
            <p>{{ offer.price }} €</p>
            <form action="{{ path('cart_add', {id: offer.id}) }}" method="POST" class="offer-form">
                <input type="hidden" name="quantity" value="1" class="quantity-input">

                <div class="quantity-buttons">
                    <button type="button" class="quantity-btn" data-qty="1">🎟️ Solo</button>
                    <button type="button" class="quantity-btn" data-qty="2">👥 Duo</button>
                    <button type="button" class="quantity-btn" data-qty="4">👨‍👩‍👧‍👦 Familiale</button>
                </div>

                <button type="submit">Ajouter au panier</button>
            </form>
            <a href="{{ path('app_offer_show', {'id': offer.id}) }}">show</a>
            <a href="{{ path('app_offer_edit', {'id': offer.id}) }}">edit</a>
        </div>
    {% else %}
        <tr>
            <td colspan="6">no records found</td>
        </tr>
    {% endfor %}
    
    <a href="{{ path('cart_index')}}">Accéder au Panier</a>

    {% if is_granted('ROLE_ADMIN') %}
        <a href="{{ path('app_offer_new') }}">Create new</a>
    {% endif %}
{% endblock %}